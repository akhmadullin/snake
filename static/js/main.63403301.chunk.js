(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{13:function(e,t,i){},15:function(e,t,i){"use strict";i.r(t);var n=i(1),s=i.n(n),a=i(7),r=i.n(a),c=(i(12),i(13),i(4)),o=i(0),d=function(){return Object(o.jsxs)("section",{className:"topic",children:[Object(o.jsx)("h1",{children:"Snake Game"}),Object(o.jsx)("p",{children:"Cool retro video game from our childhood"})]})},u=function(e){var t=e.children;return Object(o.jsxs)("section",{className:"nes-container with-title",children:[Object(o.jsx)("h3",{className:"title",children:"Let's play"}),t]})},l=function(){return Object(o.jsx)("p",{children:"Use keyboard arrows to play"})},h=function(e){var t=e.status;return Object(o.jsxs)("div",{children:["unstarted"===t&&Object(o.jsx)("span",{className:"nes-badge",children:Object(o.jsx)("span",{className:"is-dark",children:"Waiting"})}),"active"===t&&Object(o.jsx)("span",{className:"nes-badge",children:Object(o.jsx)("span",{className:"is-success",children:"Active"})}),"pause"===t&&Object(o.jsx)("span",{className:"nes-badge",children:Object(o.jsx)("span",{className:"is-warning",children:"Pause"})}),"game over"===t&&Object(o.jsx)("span",{className:"nes-badge",children:Object(o.jsx)("span",{className:"is-error",children:"Game Over"})})]})},f=function(e){var t=e.icon,i=e.value;return Object(o.jsxs)("span",{className:"scoreboard-item",children:[Object(o.jsx)("i",{className:"nes-icon ".concat(t," is-medium")}),Object(o.jsx)("span",{className:"scoreboard-item__value",children:i})]})},v=function(e){var t=e.record,i=e.score;return Object(o.jsxs)("div",{className:"scoreboard",children:[Object(o.jsx)(f,{icon:"trophy",value:t}),Object(o.jsx)(f,{icon:"coin",value:i})]})},j=Object(n.forwardRef)((function(e,t){return Object(o.jsx)("div",{className:"nes-container is-rounded",style:{marginBottom:"20px"},children:Object(o.jsx)("canvas",{ref:t,width:"660",height:"440",style:{margin:"0 auto"}})})})),b=function(e){var t=e.status,i=e.resetGame,n=e.pauseGame,s=e.continueGame;return Object(o.jsxs)("div",{className:"controls-row",children:[Object(o.jsx)("button",{type:"button",className:"nes-btn",onClick:i,children:"Reset game"}),"active"===t&&Object(o.jsx)("button",{type:"button",className:"nes-btn is-primary",onClick:n,children:"Pause"}),"pause"===t&&Object(o.jsx)("button",{type:"button",className:"nes-btn is-primary",onClick:s,children:"Continue"})]})},m=10,x={empty:"#333",food:"#fc0",snakeHead:"#fff",snakeBody:"#bbb"},y=i(2),O=i(3),g=i(5),p=function(e,t){var i=Math.ceil(e),n=Math.floor(t);return Math.floor(Math.random()*(n-i+1)+i)},k=function(){function e(t,i){Object(y.a)(this,e),this.field=void 0,this.food=void 0,this.snake=void 0,this.direction=void 0,this.score=void 0,this.score=0,this.direction="up",this.generateField(t,i),this.generateFood(),this.setFoodIntoField(),this.generateSnakeCoord(),this.setSnakeIntoField()}return Object(O.a)(e,[{key:"generateField",value:function(e,t){this.field=[];for(var i=0;i<e;i++)for(var n=0;n<t;n++)this.field[i]||(this.field[i]=[]),this.field[i][n]="empty"}},{key:"updateDirection",value:function(e){"up"!==e||"down"===this.direction?"right"!==e||"left"===this.direction?"down"!==e||"up"===this.direction?"left"===e&&"right"!==this.direction&&(this.direction="left"):this.direction="down":this.direction="right":this.direction="up"}},{key:"getRandomEmptyPoint",value:function(){for(var e=[],t=0;t<this.field.length;t++)for(var i=0;i<this.field[0].length;i++)"empty"===this.field[t][i]&&e.push({x:t,y:i});return e[p(0,e.length-1)]}},{key:"generateFood",value:function(){this.food=this.getRandomEmptyPoint()}},{key:"generateSnakeCoord",value:function(){var e=this.getRandomEmptyPoint();this.snake=[e,Object(g.a)(Object(g.a)({},e),{},{y:e.y+1}),Object(g.a)(Object(g.a)({},e),{},{y:e.y+2})]}},{key:"setFoodIntoField",value:function(){this.field[this.food.x][this.food.y]="food"}},{key:"setSnakeIntoField",value:function(){var e=this;this.snake.forEach((function(t,i){var n=t.x,s=t.y;e.field[n][s]=0===i?"snakeHead":"snakeBody"}))}},{key:"getNextHeadPoint",value:function(){var e=this.snake[0].x,t=this.field.length-1,i=this.snake[0].y,n=this.field[0].length-1;if("up"===this.direction){var s=i-1;return{x:e,y:s<0?n:s}}if("right"===this.direction){var a=e+1;return{x:a>t?0:a,y:i}}if("down"===this.direction){var r=i+1;return{x:e,y:r>n?0:r}}var c=e-1;return{x:c<0?t:c,y:i}}},{key:"getField",value:function(){return this.field}},{key:"getScore",value:function(){return this.score}},{key:"updateField",value:function(){var e=this.getNextHeadPoint();if("snakeBody"===this.field[e.x][e.y])return!1;if(this.snake.unshift(e),e.x===this.food.x&&e.y===this.food.y)this.score+=1,this.generateFood(),this.setFoodIntoField();else{var t=this.snake.pop();this.field[t.x][t.y]="empty"}return this.setSnakeIntoField(),!0}}]),e}(),w=function(){function e(t,i){Object(y.a)(this,e),this.ctx=void 0,this.scaleIndex=void 0,this.ctx=t,this.scaleIndex=i,this.scaleCanvas()}return Object(O.a)(e,[{key:"drawField",value:function(e){for(var t=e.length,i=e[0].length,n=0;n<t;n++)for(var s=0;s<i;s++)this.drawCell(n,s,e[n][s])}},{key:"drawCell",value:function(e,t,i){this.ctx.fillStyle=x[i],this.ctx.fillRect(e*m,t*m,m,m)}},{key:"scaleCanvas",value:function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.scaleIndex,this.scaleIndex)}}]),e}(),S=function(){function e(t,i,n,s,a){Object(y.a)(this,e),this.data=void 0,this.view=void 0,this.status=void 0,this.intervalId=void 0,this.callbacks=void 0,this.data=new k(n,s),this.view=new w(t,i),this.callbacks=a,this.setStatus("unstarted")}return Object(O.a)(e,[{key:"init",value:function(){this.view.drawField(this.data.getField())}},{key:"start",value:function(){this.setStatus("active"),this.go()}},{key:"setStatus",value:function(e){this.status=e,this.callbacks.onStatusChange(e)}},{key:"go",value:function(){var e=this,t=this.data.getScore();this.intervalId=setInterval((function(){if(e.data.updateField()){var i=e.data.getScore();i>t&&(t=i,e.callbacks.onScoreChange(t),e.increaseSpeed()),e.view.drawField(e.data.getField())}else e.gameOver()}),this.getSpeed())}},{key:"increaseSpeed",value:function(){clearInterval(this.intervalId),this.go()}},{key:"getSpeed",value:function(){return Math.max(50,3e3/(this.data.getScore()+10))}},{key:"gameOver",value:function(){this.setStatus("game over"),clearInterval(this.intervalId)}},{key:"pause",value:function(){this.setStatus("pause"),clearInterval(this.intervalId)}},{key:"continue",value:function(){this.start()}},{key:"reset",value:function(){clearInterval(this.intervalId)}},{key:"updateDirection",value:function(e){this.data.updateDirection(e)}},{key:"getStatus",value:function(){return this.status}}]),e}(),N={38:"up",39:"right",40:"down",37:"left"},I=Object.keys(N).map((function(e){return Number(e)})),F=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),i=Object(n.useState)(window.devicePixelRatio),s=Object(c.a)(i,2),a=s[0],r=s[1],f=Object(n.useState)(0),x=Object(c.a)(f,2),y=x[0],O=x[1],g=Object(n.useState)(Number(window.localStorage.getItem("record"))),p=Object(c.a)(g,2),k=p[0],w=p[1],F=Object(n.useState)("unstarted"),C=Object(c.a)(F,2),E=C[0],L=C[1],R=function(){var i=e.current;if(i){var n=i.getContext("2d");t.current&&"unstarted"!==t.current.getStatus()&&t.current.reset();var s=new S(n,a,i.width/m/a,i.height/m/a,{onScoreChange:O,onStatusChange:L});s.init(),t.current=s,O(0),L("unstarted")}};return Object(n.useLayoutEffect)((function(){var e=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1), (min-resolution: 2dppx)"),t=function(){r(window.devicePixelRatio),R()};return e.addEventListener&&e.removeEventListener?(e.addEventListener("change",t),function(){e.removeEventListener("change",t)}):(e.addListener(t),function(){e.removeListener(t)})}),[]),Object(n.useEffect)((function(){if("game over"===E){var e=Number(window.localStorage.getItem("record"));y>e&&window.localStorage.setItem("record",y.toString())}}),[E,y]),Object(n.useEffect)((function(){y>=k&&w(y)}),[y,k]),Object(n.useLayoutEffect)((function(){R()}),[]),Object(n.useLayoutEffect)((function(){var e=function(e){var i=e.keyCode;if(I.includes(i)){e.preventDefault();var n=t.current;"unstarted"===n.getStatus()&&n.start(),n.updateDirection(N[i])}};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),Object(o.jsxs)("div",{className:"content-wrapper",children:[Object(o.jsx)(d,{}),Object(o.jsxs)(u,{children:[Object(o.jsx)(l,{}),Object(o.jsxs)("div",{className:"info-row",children:[Object(o.jsx)(h,{status:E}),Object(o.jsx)(v,{record:k,score:y})]}),Object(o.jsx)(j,{ref:e}),Object(o.jsx)(b,{status:E,resetGame:R,pauseGame:function(){t.current.pause()},continueGame:function(){t.current.continue()}})]})]})},C=function(){return Object(o.jsx)(F,{})},E=function(){return Object(o.jsx)("div",{children:Object(o.jsx)(C,{})})};r.a.render(Object(o.jsx)(s.a.StrictMode,{children:Object(o.jsx)(E,{})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.63403301.chunk.js.map