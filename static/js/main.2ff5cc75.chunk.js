(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{13:function(e,t,i){},15:function(e,t,i){"use strict";i.r(t);var n=i(1),s=i.n(n),a=i(7),c=i.n(a),r=(i(12),i(13),i(0)),o=function(){return Object(r.jsxs)("section",{className:"topic",children:[Object(r.jsx)("h1",{children:"Snake Game"}),Object(r.jsx)("p",{children:"Cool retro video game from our childhood"})]})},u=i(4),d=function(e){var t=e.children;return Object(r.jsxs)("section",{className:"nes-container with-title",children:[Object(r.jsx)("h3",{className:"title",children:"Let's play"}),t]})},l=function(){return Object(r.jsx)("p",{children:"Use keyboard arrows to play"})},h=function(e){var t=e.status;return Object(r.jsxs)("div",{children:["unstarted"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-dark",children:"Waiting"})}),"active"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-primary",children:"Active"})}),"pause"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-warning",children:"Pause"})}),"game over"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-error",children:"Game Over"})})]})},f=function(e){var t=e.icon,i=e.value;return Object(r.jsxs)("span",{className:"scoreboard-item",children:[Object(r.jsx)("i",{className:"nes-icon ".concat(t," is-medium")}),Object(r.jsx)("span",{className:"scoreboard-item__value",children:i})]})},v=function(e){var t=e.record,i=e.score;return Object(r.jsxs)("div",{className:"scoreboard",children:[Object(r.jsx)(f,{icon:"trophy",value:t}),Object(r.jsx)(f,{icon:"coin",value:i})]})},j=Object(n.forwardRef)((function(e,t){var i=e.width,n=e.height,s=e.scaleIndex;return Object(r.jsx)("div",{className:"nes-container is-rounded",style:{marginBottom:"20px"},children:Object(r.jsx)("canvas",{ref:t,width:i*s,height:n*s,style:{margin:"0 auto",width:"".concat(i,"px"),height:"".concat(n,"px")}})})})),b=function(e){return function(t){e(),t.target.blur()}},p=function(e){var t=e.status,i=e.generateNewGame,n=e.pauseGame,s=e.continueGame;return Object(r.jsxs)("div",{className:"controls-row",children:[Object(r.jsx)("button",{type:"button",className:"nes-btn",onClick:b(i),children:"Play new game"}),"active"===t&&Object(r.jsx)("button",{type:"button",className:"nes-btn is-warning",onClick:b(n),children:"Pause"}),"pause"===t&&Object(r.jsx)("button",{type:"button",className:"nes-btn is-primary",onClick:b(s),children:"Continue"})]})},m=i(2),y=i(3),x=function(){function e(){Object(m.a)(this,e),this.items=void 0,this.items=[]}return Object(y.a)(e,[{key:"enqueue",value:function(e){this.items.push(e)}},{key:"dequeue",value:function(){return this.items.shift()}},{key:"isEmpty",value:function(){return 0===this.items.length}},{key:"last",get:function(){return this.items[this.items.length-1]}}]),e}(),g=i(5),O=function(e,t){var i=Math.ceil(e),n=Math.floor(t);return Math.floor(Math.random()*(n-i+1)+i)},k=function(){function e(t,i){Object(m.a)(this,e),this.field=void 0,this.food=void 0,this.snake=void 0,this.direction=void 0,this.score=void 0,this.score=0,this.direction="up",this.generateField(t,i),this.generateFood(),this.setFoodIntoField(),this.generateSnakeCoord(),this.setSnakeIntoField()}return Object(y.a)(e,[{key:"generateField",value:function(e,t){this.field=[];for(var i=0;i<e;i++)for(var n=0;n<t;n++)this.field[i]||(this.field[i]=[]),this.field[i][n]="empty"}},{key:"updateDirection",value:function(e){"up"!==e||"down"===this.direction?"right"!==e||"left"===this.direction?"down"!==e||"up"===this.direction?"left"===e&&"right"!==this.direction&&(this.direction="left"):this.direction="down":this.direction="right":this.direction="up"}},{key:"getRandomEmptyPoint",value:function(){for(var e=[],t=0;t<this.field.length;t++)for(var i=0;i<this.field[0].length;i++)"empty"===this.field[t][i]&&e.push({x:t,y:i});return e[O(0,e.length-1)]}},{key:"generateFood",value:function(){this.food=this.getRandomEmptyPoint()}},{key:"generateSnakeCoord",value:function(){var e=this.getRandomEmptyPoint();this.snake=[e,Object(g.a)(Object(g.a)({},e),{},{y:e.y+1}),Object(g.a)(Object(g.a)({},e),{},{y:e.y+2})]}},{key:"setFoodIntoField",value:function(){this.field[this.food.x][this.food.y]="food"}},{key:"setSnakeIntoField",value:function(){var e=this;this.snake.forEach((function(t,i){var n=t.x,s=t.y;e.field[n][s]=0===i?"snakeHead":"snakeBody"}))}},{key:"getNextHeadPoint",value:function(){var e=this.snake[0].x,t=this.field.length-1,i=this.snake[0].y,n=this.field[0].length-1;if("up"===this.direction){var s=i-1;return{x:e,y:s<0?n:s}}if("right"===this.direction){var a=e+1;return{x:a>t?0:a,y:i}}if("down"===this.direction){var c=i+1;return{x:e,y:c>n?0:c}}var r=e-1;return{x:r<0?t:r,y:i}}},{key:"getField",value:function(){return this.field}},{key:"getScore",value:function(){return this.score}},{key:"updateField",value:function(){var e=this.getNextHeadPoint();if("snakeBody"===this.field[e.x][e.y])return!1;if(this.snake.unshift(e),e.x===this.food.x&&e.y===this.food.y)this.score+=1,this.generateFood(),this.setFoodIntoField();else{var t=this.snake.pop();this.field[t.x][t.y]="empty"}return this.setSnakeIntoField(),!0}}]),e}(),w=20,S={empty:"#333",food:"#fc0",snakeHead:"#fff",snakeBody:"#bbb"},I=function(){function e(t,i){Object(m.a)(this,e),this.ctx=void 0,this.scaleIndex=void 0,this.ctx=t,this.scaleIndex=i,this.scaleCanvas()}return Object(y.a)(e,[{key:"drawField",value:function(e){for(var t=e.length,i=e[0].length,n=0;n<t;n++)for(var s=0;s<i;s++)this.drawCell(n,s,e[n][s])}},{key:"drawCell",value:function(e,t,i){this.ctx.fillStyle=S[i],this.ctx.fillRect(e*w,t*w,w,w)}},{key:"scaleCanvas",value:function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.scaleIndex,this.scaleIndex)}},{key:"updateScaleIndex",value:function(e){this.scaleIndex=e,this.scaleCanvas()}}]),e}(),N=function(){function e(t,i,n,s,a){Object(m.a)(this,e),this.data=void 0,this.view=void 0,this.status=void 0,this.directionsToApply=void 0,this.callbacks=void 0,this.intervalId=void 0,this.data=new k(n,s),this.view=new I(t,i),this.directionsToApply=new x,this.callbacks=a,this.setStatus("unstarted")}return Object(y.a)(e,[{key:"init",value:function(){this.view.drawField(this.data.getField())}},{key:"start",value:function(){this.setStatus("active"),this.go()}},{key:"setStatus",value:function(e){this.status=e,this.callbacks.onStatusChange(e)}},{key:"go",value:function(){var e=this,t=this.data.getScore();this.intervalId=setInterval((function(){if(e.data.updateField()){var i=e.data.getScore();if(i>t&&(t=i,e.callbacks.onScoreChange(t),e.increaseSpeed()),!e.directionsToApply.isEmpty()){var n=e.directionsToApply.dequeue();e.data.updateDirection(n)}e.view.drawField(e.data.getField())}else e.gameOver()}),this.getSpeed())}},{key:"increaseSpeed",value:function(){clearInterval(this.intervalId),this.go()}},{key:"getSpeed",value:function(){return Math.max(50,3e3/(this.data.getScore()+10))}},{key:"gameOver",value:function(){this.setStatus("game over"),clearInterval(this.intervalId)}},{key:"pause",value:function(){this.setStatus("pause"),clearInterval(this.intervalId)}},{key:"continue",value:function(){this.start()}},{key:"reset",value:function(){clearInterval(this.intervalId)}},{key:"updateDirection",value:function(e){this.directionsToApply.last!==e&&this.directionsToApply.enqueue(e)}},{key:"getStatus",value:function(){return this.status}},{key:"fixScaleIndexChange",value:function(e){this.view.updateScaleIndex(e),this.view.drawField(this.data.getField())}}]),e}(),F={38:"up",39:"right",40:"down",37:"left"},C=Object.keys(F).map((function(e){return Number(e)})),E=[13,32],L=660,P=440,R=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),i=Object(n.useState)(window.devicePixelRatio),s=Object(u.a)(i,2),a=s[0],c=s[1],o=Object(n.useState)(0),f=Object(u.a)(o,2),b=f[0],m=f[1],y=Object(n.useState)(Number(window.localStorage.getItem("record"))),x=Object(u.a)(y,2),g=x[0],O=x[1],k=Object(n.useState)("unstarted"),S=Object(u.a)(k,2),I=S[0],R=S[1],G=function(){var i=e.current;if(i){var n=i.getContext("2d");t.current&&"unstarted"!==t.current.getStatus()&&t.current.reset();var s=new N(n,a,L/w,P/w,{onScoreChange:m,onStatusChange:R});s.init(),t.current=s,m(0),R("unstarted")}},A=function(){t.current.pause()},M=function(){t.current.continue()};return Object(n.useLayoutEffect)((function(){var e=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1), (min-resolution: 2dppx)"),t=function(){c(window.devicePixelRatio)};return e.addEventListener&&e.removeEventListener?(e.addEventListener("change",t),function(){e.removeEventListener("change",t)}):(e.addListener(t),function(){e.removeListener(t)})}),[]),Object(n.useEffect)((function(){t.current.fixScaleIndexChange(a)}),[a]),Object(n.useLayoutEffect)((function(){G()}),[]),Object(n.useEffect)((function(){b>g&&(O(b),window.localStorage.setItem("record",b.toString()))}),[b,g]),Object(n.useEffect)((function(){var e=function(e){var i=e.keyCode,n=t.current,s=n.getStatus();C.includes(i)&&(e.preventDefault(),"unstarted"===s&&n.start(),"pause"===s&&M(),n.updateDirection(F[i])),E.includes(i)&&e.target===document.body&&(e.preventDefault(),"unstarted"===s&&n.start(),"active"===s&&A(),"pause"===s&&M(),"game over"===s&&G())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),Object(r.jsxs)(d,{children:[Object(r.jsx)(l,{}),Object(r.jsxs)("div",{className:"info-row",children:[Object(r.jsx)(h,{status:I}),Object(r.jsx)(v,{record:g,score:b})]}),Object(r.jsx)(j,{ref:e,scaleIndex:a,width:L,height:P}),Object(r.jsx)(p,{status:I,generateNewGame:G,pauseGame:A,continueGame:M})]})},G=function(){return Object(r.jsxs)("div",{className:"content-wrapper",children:[Object(r.jsx)(o,{}),Object(r.jsx)(R,{})]})},A=function(){return Object(r.jsx)(G,{})};c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(A,{})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.2ff5cc75.chunk.js.map