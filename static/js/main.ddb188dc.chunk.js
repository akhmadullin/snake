(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),s=n(7),c=n.n(s),r=(n(12),n(13),n(0)),o=function(){return Object(r.jsxs)("section",{className:"topic",children:[Object(r.jsx)("h1",{children:"Snake Game"}),Object(r.jsx)("p",{children:"Cool retro video game from our childhood"})]})},d=n(4),u=function(e){var t=e.children;return Object(r.jsxs)("section",{className:"nes-container with-title",children:[Object(r.jsx)("h3",{className:"title",children:"Let's play"}),t]})},l=function(){return Object(r.jsx)("p",{children:"Use keyboard arrows to play"})},h=function(e){var t=e.status;return Object(r.jsxs)("div",{children:["unstarted"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-dark",children:"Waiting"})}),"active"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-primary",children:"Active"})}),"pause"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-warning",children:"Pause"})}),"game over"===t&&Object(r.jsx)("span",{className:"nes-badge",children:Object(r.jsx)("span",{className:"is-error",children:"Game Over"})})]})},f=function(e){var t=e.icon,n=e.value;return Object(r.jsxs)("span",{className:"scoreboard-item",children:[Object(r.jsx)("i",{className:"nes-icon ".concat(t," is-medium")}),Object(r.jsx)("span",{className:"scoreboard-item__value",children:n})]})},v=function(e){var t=e.record,n=e.score;return Object(r.jsxs)("div",{className:"scoreboard",children:[Object(r.jsx)(f,{icon:"trophy",value:t}),Object(r.jsx)(f,{icon:"coin",value:n})]})},j=Object(i.forwardRef)((function(e,t){var n=e.width,i=e.height,a=e.scaleIndex;return Object(r.jsx)("div",{className:"nes-container is-rounded",style:{marginBottom:"20px"},children:Object(r.jsx)("canvas",{ref:t,width:n*a,height:i*a,style:{margin:"0 auto",width:"".concat(n,"px"),height:"".concat(i,"px")}})})})),b=function(e){return function(t){e(),t.target.blur()}},x=function(e){var t=e.status,n=e.generateNewGame,i=e.pauseGame,a=e.continueGame;return Object(r.jsxs)("div",{className:"controls-row",children:[Object(r.jsx)("button",{type:"button",className:"nes-btn",onClick:b(n),children:"Play new game"}),"active"===t&&Object(r.jsx)("button",{type:"button",className:"nes-btn is-warning",onClick:b(i),children:"Pause"}),"pause"===t&&Object(r.jsx)("button",{type:"button",className:"nes-btn is-primary",onClick:b(a),children:"Continue"})]})},g=n(2),m=n(3),p=n(5),y=function(e,t){var n=Math.ceil(e),i=Math.floor(t);return Math.floor(Math.random()*(i-n+1)+n)},O=function(){function e(t,n){Object(g.a)(this,e),this.field=void 0,this.food=void 0,this.snake=void 0,this.direction=void 0,this.score=void 0,this.score=0,this.direction="up",this.generateField(t,n),this.generateFood(),this.setFoodIntoField(),this.generateSnakeCoord(),this.setSnakeIntoField()}return Object(m.a)(e,[{key:"generateField",value:function(e,t){this.field=[];for(var n=0;n<e;n++)for(var i=0;i<t;i++)this.field[n]||(this.field[n]=[]),this.field[n][i]="empty"}},{key:"updateDirection",value:function(e){"up"!==e||"down"===this.direction?"right"!==e||"left"===this.direction?"down"!==e||"up"===this.direction?"left"===e&&"right"!==this.direction&&(this.direction="left"):this.direction="down":this.direction="right":this.direction="up"}},{key:"getRandomEmptyPoint",value:function(){for(var e=[],t=0;t<this.field.length;t++)for(var n=0;n<this.field[0].length;n++)"empty"===this.field[t][n]&&e.push({x:t,y:n});return e[y(0,e.length-1)]}},{key:"generateFood",value:function(){this.food=this.getRandomEmptyPoint()}},{key:"generateSnakeCoord",value:function(){var e=this.getRandomEmptyPoint();this.snake=[e,Object(p.a)(Object(p.a)({},e),{},{y:e.y+1}),Object(p.a)(Object(p.a)({},e),{},{y:e.y+2})]}},{key:"setFoodIntoField",value:function(){this.field[this.food.x][this.food.y]="food"}},{key:"setSnakeIntoField",value:function(){var e=this;this.snake.forEach((function(t,n){var i=t.x,a=t.y;e.field[i][a]=0===n?"snakeHead":"snakeBody"}))}},{key:"getNextHeadPoint",value:function(){var e=this.snake[0].x,t=this.field.length-1,n=this.snake[0].y,i=this.field[0].length-1;if("up"===this.direction){var a=n-1;return{x:e,y:a<0?i:a}}if("right"===this.direction){var s=e+1;return{x:s>t?0:s,y:n}}if("down"===this.direction){var c=n+1;return{x:e,y:c>i?0:c}}var r=e-1;return{x:r<0?t:r,y:n}}},{key:"getField",value:function(){return this.field}},{key:"getScore",value:function(){return this.score}},{key:"updateField",value:function(){var e=this.getNextHeadPoint();if("snakeBody"===this.field[e.x][e.y])return!1;if(this.snake.unshift(e),e.x===this.food.x&&e.y===this.food.y)this.score+=1,this.generateFood(),this.setFoodIntoField();else{var t=this.snake.pop();this.field[t.x][t.y]="empty"}return this.setSnakeIntoField(),!0}}]),e}(),k=20,w={empty:"#333",food:"#fc0",snakeHead:"#fff",snakeBody:"#bbb"},S=function(){function e(t,n){Object(g.a)(this,e),this.ctx=void 0,this.scaleIndex=void 0,this.ctx=t,this.scaleIndex=n,this.scaleCanvas()}return Object(m.a)(e,[{key:"drawField",value:function(e){for(var t=e.length,n=e[0].length,i=0;i<t;i++)for(var a=0;a<n;a++)this.drawCell(i,a,e[i][a])}},{key:"drawCell",value:function(e,t,n){this.ctx.fillStyle=w[n],this.ctx.fillRect(e*k,t*k,k,k)}},{key:"scaleCanvas",value:function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.scaleIndex,this.scaleIndex)}},{key:"updateScaleIndex",value:function(e){this.scaleIndex=e,this.scaleCanvas()}}]),e}(),I=function(){function e(t,n,i,a,s){Object(g.a)(this,e),this.data=void 0,this.view=void 0,this.status=void 0,this.intervalId=void 0,this.callbacks=void 0,this.data=new O(i,a),this.view=new S(t,n),this.callbacks=s,this.setStatus("unstarted")}return Object(m.a)(e,[{key:"init",value:function(){this.view.drawField(this.data.getField())}},{key:"start",value:function(){this.setStatus("active"),this.go()}},{key:"setStatus",value:function(e){this.status=e,this.callbacks.onStatusChange(e)}},{key:"go",value:function(){var e=this,t=this.data.getScore();this.intervalId=setInterval((function(){if(e.data.updateField()){var n=e.data.getScore();n>t&&(t=n,e.callbacks.onScoreChange(t),e.increaseSpeed()),e.view.drawField(e.data.getField())}else e.gameOver()}),this.getSpeed())}},{key:"increaseSpeed",value:function(){clearInterval(this.intervalId),this.go()}},{key:"getSpeed",value:function(){return Math.max(50,3e3/(this.data.getScore()+10))}},{key:"gameOver",value:function(){this.setStatus("game over"),clearInterval(this.intervalId)}},{key:"pause",value:function(){this.setStatus("pause"),clearInterval(this.intervalId)}},{key:"continue",value:function(){this.start()}},{key:"reset",value:function(){clearInterval(this.intervalId)}},{key:"updateDirection",value:function(e){this.data.updateDirection(e)}},{key:"getStatus",value:function(){return this.status}},{key:"fixScaleIndexChange",value:function(e){this.view.updateScaleIndex(e),this.view.drawField(this.data.getField())}}]),e}(),N={38:"up",39:"right",40:"down",37:"left"},F=Object.keys(N).map((function(e){return Number(e)})),C=[13,32],E=660,L=440,P=function(){var e=Object(i.useRef)(null),t=Object(i.useRef)(null),n=Object(i.useState)(window.devicePixelRatio),a=Object(d.a)(n,2),s=a[0],c=a[1],o=Object(i.useState)(0),f=Object(d.a)(o,2),b=f[0],g=f[1],m=Object(i.useState)(Number(window.localStorage.getItem("record"))),p=Object(d.a)(m,2),y=p[0],O=p[1],w=Object(i.useState)("unstarted"),S=Object(d.a)(w,2),P=S[0],R=S[1],G=function(){var n=e.current;if(n){var i=n.getContext("2d");t.current&&"unstarted"!==t.current.getStatus()&&t.current.reset();var a=new I(i,s,E/k,L/k,{onScoreChange:g,onStatusChange:R});a.init(),t.current=a,g(0),R("unstarted")}},M=function(){t.current.pause()},D=function(){t.current.continue()};return Object(i.useLayoutEffect)((function(){var e=window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1), (min-resolution: 2dppx)"),t=function(){c(window.devicePixelRatio)};return e.addEventListener&&e.removeEventListener?(e.addEventListener("change",t),function(){e.removeEventListener("change",t)}):(e.addListener(t),function(){e.removeListener(t)})}),[]),Object(i.useEffect)((function(){t.current.fixScaleIndexChange(s)}),[s]),Object(i.useLayoutEffect)((function(){G()}),[]),Object(i.useEffect)((function(){b>y&&(O(b),window.localStorage.setItem("record",b.toString()))}),[b,y]),Object(i.useEffect)((function(){var e=function(e){var n=e.keyCode,i=t.current,a=i.getStatus();F.includes(n)&&(e.preventDefault(),"unstarted"===a&&i.start(),"pause"===a&&D(),i.updateDirection(N[n])),C.includes(n)&&e.target===document.body&&(e.preventDefault(),"unstarted"===a&&i.start(),"active"===a&&M(),"pause"===a&&D(),"game over"===a&&G())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),Object(r.jsxs)(u,{children:[Object(r.jsx)(l,{}),Object(r.jsxs)("div",{className:"info-row",children:[Object(r.jsx)(h,{status:P}),Object(r.jsx)(v,{record:y,score:b})]}),Object(r.jsx)(j,{ref:e,scaleIndex:s,width:E,height:L}),Object(r.jsx)(x,{status:P,generateNewGame:G,pauseGame:M,continueGame:D})]})},R=function(){return Object(r.jsxs)("div",{className:"content-wrapper",children:[Object(r.jsx)(o,{}),Object(r.jsx)(P,{})]})},G=function(){return Object(r.jsx)(R,{})};c.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(G,{})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.ddb188dc.chunk.js.map